---
title: Airbnb
date: 2022-10-27 10:52:22
category: clone
tag: [Python, Backend, Django]
excerpt: "Django"
cover_image: /images/posts/django.png
draft: true
---

# poetry

node.js에서 패키지 매니저로 npm을 사용했다면 파이썬은 pip라는 패키지 매니저가 존재한다.
하지만 pip는 설계가 굉장히 불편한데 우선 패키지를 global하게 설치한다.
이 때문에 모든 파이썬 앱이 같은 버전의 패키지를 사용해야 하고, 혹여나 지원하지 않는 기능이 생기면 프로젝트가 망가지게 된다.
그리고 같은 패키지를 여러 버전을 설치할 수 없으므로, 모듈 의존성 상에 여러 버전이 필요할 경우 대응할 수 없게 된다.
pip는 락 파일이 없으므로 패키지 버전을 고정해서 사용할 수 없다.
물론 requirements.txt 파일로 관리할 수 있긴하지만, 사람이 직접 관리해야하므로 실수할 가능성이 높아진다.
위와 같은 문제 때문에 pip 대신에 poetry를 사용한다.
poetry는 앞서 설명한 문제를 모두 해결해준다.
lock 파일을 사용해서 패키지의 버전을 고정해서 사용할 수 있고, 각 프로젝트마다 로컬하게 패키지를 설치할 수 있다.

## installation

[poetry](https://python-poetry.org/docs/)에서 각 운영체제에 맞는 설치법을 볼 수 있다.
나는 macOS를 사용하므로 `curl -sSL https://install.python-poetry.org | python3 -`로 설치해줬다.
poetry가 제대로 설치되었는지 확인하기 위해 `poetry`를 입력해보자.
여기서 나는 *zsh: command not found: poetry*라는 오류가 발생했었다.
이는 zsh가 poetry의 위치를 모르기 때문에 발생하는 문제다.
우선 poetry 파일 위치를 알 필요가 있다.
나는 ~/.local/bin에 poetry 파일이 있었다.
위 경로를 ~/.zshrc 파일에 추가해줘야 하는데, 제일 아랫줄에 `export PATH=$HOME/.local/bin:$PATH`를 추가한다.
다시 poetry를 입력하면 poetry가 정상적으로 작동한다.

## init

poetry를 실행하기 전에 프로젝트를 만들 폴더를 하나 만든다.
그리고 터미널을 열어서 해당 폴더로 이동한다.
poetry로 새로운 환경을 구성하려면 터미널에 `poetry init`을 입력한다.
그러면 몇 가지 질문과 설정해야할 내용이 나온다.
대부분 내용을 엔터로 넘기면 되는데, License는 MIT로 설정한다.
그리고 질문은 마지막 내용만 yes로 하고 나머지는 no로 한다.

```
Package name [airbnb-backend]:
Version [0.1.0]:
Description []:
Author [Sangho, n to skip]:
License []:  MIT
Compatible Python versions [^3.9]:

Would you like to define your main dependencies interactively? (yes/no) [yes] no
Would you like to define your development dependencies interactively? (yes/no) [yes] no
Generated file

[tool.poetry]
name = "airbnb-backend"
version = "0.1.0"
description = ""
authors = ["Sangho"]
license = "MIT"
readme = "README.md"
packages = [{include = "airbnb_backend"}]

[tool.poetry.dependencies]
python = "^3.9"


[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"


Do you confirm generation? (yes/no) [yes] yes
```

폴더를 보면 pyproject.toml이라는 파일이 생성되었다.
파일은 우리가 사용하는 패키지의 버전 정보를 포함하고 있는데, 예를 들어 파이썬의 버전이 포함된다.
여기에 django를 추가하기 위해 `poetry add django`를 입력한다.
폴더에 poetry.lock 파일이 생성되는데, 여기엔 코드가 실행되는데 필요한 환경 정보가 저장된다.

`poetry shell`로 poetry에 들어가면 django 명령어를 실행할 수 있게 된다.
`django-admin`로 django를 실행시켜서 정장적으로 장동하는지 알아보자.
그리고 exit을 입력해서 poetry를 종료시킨다.
앞으로 터미널에 명령어를 입력할때는 poetry를 열었다는 가정하에 진행한다.
혹시나 명령어가 제대로 동작하지 않으면 poetry를 실행시켰는지 확인해보자.

django 프로젝트를 만들기 위해 `django-admin startproject config .`를 입력한다.
.을 적는 이유는 현재 위치에 프로젝트 파일을 만들기 위해서다.
config 폴더를 열어보면 여러 파이썬 파일이 있다.
추가로 gitignore를 만들어주면 되는데, vscode의 extension을 사용하면 간단하게 만들 수 있다.
extension에서 gitignore를 검색하고 설치한다.
그 후 설정 > command palette > add gitignore > python으로 gitignore 파일을 만든다.
