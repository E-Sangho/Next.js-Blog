---
title: Application Layer
date: 2022-06-26 10:15:21
category: 카테고리
tag: [Networking, CS]
series: Computer Networking a Top-Down Apporach
excerpt: "A summary of Application Layer of TCP/IP"
cover_image: /images/posts/networking.jpg
draft: true
---

# Application Layer

## 애플리케이션이란 무엇인가?

많은 사람들이 프로그램은 컴퓨터에 설치된 파일, 애플리케이션은 스마트폰에 설치된 파일이라 생각한다.
사실상 둘은 별 차이가 없는데, 애초에 응용 프로그램이 Application Software의 번역어기 때문이다.
결국 컴퓨터든 스마트폰이든 관계 없이 운영체제에서 실행되는 _소프트웨어/프로그램을 애플리케이션이라 한다._

### 애플리케이션 구조엔 어떤 것이 있는가?

애플리케이션은 크게 2가지 구조를 사용한다.
하나는 _Client-Server_ 구조다.
클라이언트에서 서버에 요청을 보내면 서버는 그에 맞는 응답을 해준다.
클라이언트와 서버로 나눈 이유는 편의성과 보안적 문제 때문이다.
만약 클라이언트에서 모든 사용자 정보를 볼 수 있고, 파일을 삭제할 권한이 주어지며, 여러 거래 내역을 볼 수 있다고 해보자.
당연하게도 이렇게 되면 다른 사람의 개인 정보를 볼 수 있고, 필수적인 파일이 삭제되고는 등 심각한 피해가 발생한다.
이렇게 강력한 권한은 다수에게 배포되는 것이 아니라, 소수가 집중적으로 관리할 필요가 있다.
그러므로 클라이언트에게 너무 많은 권한을 주지 않고, 이를 서버에서만 실행되도록 만든 것이다.
또한 작업이 여러 분산된 장소에서 동작하면 관리하기 어려워지는데, 이를 방지하기 위해서도 서버가 필요하다.
결국 서버와 클라이언트로 나눈 이유는 경제적으로 비용이 저렴하고, 안정적으로 동작하기 위해서다.
하지만 서버에 모든 내용이 집중되어 있으므로 해킹에 취약하고, 디도스 공격으로 서버가 마비되는 일도 발생한다.
특히 서버측의 데이터가 변경될 경우 모든 클라이언트가 피해를 보게 되므로 기업에서는 서버의 보안에 많은 신경을 쓴다.
+ip주소

클라이언트 수가 늘어나면 하나의 서버만으로 요청을 처리하기 어려워진다.
그래서 여러 서버와 저장소를 설치한 *데이터 센터*를 만들게 된다.
데이터 센터는 기업의 서버와 스토리지를 효과적으로 운영하기 위해 한 곳에 모아 놓은 시설을 의미한다.
이를 보조하기 위해 전력, 네트워크 환경, 보안, 백업 등 다양한 시설이 추가로 필요하다.

그런데 클라이언트에서 단순한 동작만 하면 서버가 필요 없을 수 있다.
파일을 전송하기만 한다면 위처럼 보안적 문제가 발생하지 않으므로 별도로 서버가 필요없다.
이때 사용하는 것이 _P2P(Peer to Peer)_ 구조다.
P2P는 클라이언트들이 서로 직접적으로 통신하는 방법이다.
별도의 서버가 필요하지 않으므로 간편하고, 유지에 많은 비용이 들지 않는다.
대표적으로 토렌트, 블록체인, 화상통화 등에 사용한다.
문제는 서버를 경우하지 않으므로 클라이언트가 보호받지 못한다는 점이다.
불법적인 파일을 검출해내기 어렵고, 클라이언트의 IP가 직접적으로 노출된다.

### 애플리케이션 간 통신

책에서는 애플리케이션이 실행중이라는 것을 강조하기 위해 프로세스란 용어를 사용한다.
같은 컴퓨터 내에서 프로세스 통신은 운영체제가 담당한다.
그렇지만 우리는 서로 다른 컴퓨터간의 통신에 관심이 있으므로 이 주제는 운영체제에서 배운다.
앞으로 프로세스간 통신은 다른 두 컴퓨터간의 통신을 말한다.

#### 메시지란 무엇인가?

두 컴퓨터 간의 통신 시에 단순히 내용만을 전송할 순 없다.
내용외에도 추가적인 정보가 필요한데, 예를 들어 사용하는 언어, 연결 여부, 호스트 주소, 요청 성공 여부 등이 필요하다.
그래서 컴퓨터는 내용에 추가적인 정보를 덧붙일 필요가 있는데, 컨텐츠에 필요한 정보를 더한 것을 *메시지*라고 한다.
메시지는 내용 뿐만 아니라 통신에 필요한 정보를 모두 담고 있으므로 프로세스간 통신은 _메시지_ 교환으로 이뤄진다.

#### 메시지 전송은 어떻게 이뤄지는가?

이때 메시지가 어떤 형태로 되어 있고 어떤 방법으로 전송하는지 궁금할 것이다.
이는 애플리케이션의 프로토콜이 결정한다.
프로토콜은 메시지 타입, 문법, 전송/응답 규칙을 결정한다.
그래서 다른 프로토콜마다 메시지의 형태가 다른데, 이후에 각 프로토콜마다 메시지가 어떻게 구성되는지 살펴볼 것이다.

프로토콜의 전송 방법은 TCP와 UDP 2종류가 있다.
둘의 자세한 내용은 이후에 다루기로 하고 여기서는 간략한 내용만 다루겠다.
핵심적인 차이는 오류 발생시 재전송 여부다.
네트워크 통신을 하다보면 데이터가 누락되는 경우가 발생한다.
이때 TCP는 데이터 누락을 검사해서 다시 데이터를 전송받는다.
반면 UDP는 누락된 데이터는 무시하고 이후의 데이터를 받는다.

TCP는 내용이 누락되어선 안 되는 대부분의 서비스에서 사용한다.
예를 들어 파일 전송, 메일, 웹 페이지, 스트리밍에서 널리 쓰인다.
UDP는 주로 실시간으로 사용되는 서비스에서 쓰인다.
예를 들어서 화상 통화, 게임 등은 실시간으로 이뤄지므로 지나간 정보가 누락된 것을 신경쓰지 않는다.
이런 서비스에서 원하는 속도로 메시지를 보낼 수 있는 UDP가 선호된다.

#### 포트

메시지의 전송 방법은 프로토콜이 결정하고 하위 레이어에 위임되어 전달된다.
그런데 전송이 완료된 이후에 어떤 프로세스에 전달될지 어떻게 결정할까?
예를 들어서 A, B 프로세스를 동시에 실행되고 있다고 하자.
그리고 컴퓨터가 네트워크 전송 결과를 받았다면, 이 결과가 A의 것인지 B의 것인지 어떻게 결정할까?
이는 포트를 추가함으로써 가능하다.
포트는 구분을 위해 추가하는 고유값이다.
예를 들어 A는 포트 번호 4000번을 할당받고, B는 포트 번호 5000번을 할당 받았다고 하자.
그러면 메시지에는 포트 번호가 포함되어 전송되고, 컴퓨터는 포트 번호를 통해 어떤 프로세스로 내용을 전달해야 할지 알게 된다.

#### 소켓

프로세스에는 네트워크 통신을 담당하는 부분이 필요하다.
앞서 살펴봤듯이 네트워크 통신을 위해서는 프로토콜, IP 주소, 포트 번호가 필요하다.
프로세스는 네트워크 통신을 담당하는 *소켓*을 사용한다.
소켓은 내용을 전달할 때, 적절한 내용을 붙여서 메시지로 만들고 이를 운영체제로 전달한다.
그리고 목적지에 도착하면 운영체제는 메시지의 포트 번호를 보고 적절한 소켓에게 내용을 전달해준다.
이처럼 소켓은 프로세스와 네트워크 간의 인터페이스로 작동한다.
소켓 = API
애플리케이션에서 소켓을 선언하고 사용하지만 모든 내용이 애플리케이션에서 관리되진 않는다.
상당수의 내용이 운영체제에게 위임되고 이들은 다시 통신 장치로 전달된다.
그러므로 애플리케이션은 소켓의 프로토콜, 세그먼트 크기 설정, 버퍼 크기 결정 등 몇 가지 일만 수행 가능하다.

## HTTP(HyperText Transfer Protocol)

메시지의 구조와 클라이언트와 서버가 어떻게 메시지를 교환하는지 정의하고 있다.
요청/응답 메시지
TCP 신뢰적 연결
SSL(Secure Sockets Layer)

TCP를 전송 프로토콜로 사용
stateless protocol
persistent connection, non-persistent connection.

HTTP 통신이란?
비지속연결과 지속연결
HTTP 메세지의 형태
쿠키란?
세션이란?
웹 캐싱과 프록시 서버란?

DNS

비디오 스트리밍
CDN

이메일

P2P

소켓 프로그래밍 실습
